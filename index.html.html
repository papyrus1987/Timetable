<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë°©ê³¼ í›„ ì‹œê°„í‘œ</title>
<link href="https://fonts.googleapis.com/css2?family=Gaegu:wght@700&family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Noto Sans KR', sans-serif;
  background: #eef0f3;
  min-height: 100vh;
  padding: 36px 20px 60px;
}

.container {
  max-width: 860px;
  margin: 0 auto;
}

h1 {
  font-family: 'Gaegu', cursive;
  font-size: 2.8rem;
  text-align: center;
  color: #4a5568;
  margin-bottom: 6px;
  letter-spacing: 2px;
}

.subtitle {
  text-align: center;
  font-size: 0.82rem;
  color: #999;
  margin-bottom: 10px;
}

.info-badges {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin-bottom: 26px;
  flex-wrap: wrap;
}

.badge {
  padding: 5px 16px;
  border-radius: 30px;
  font-size: 0.78rem;
  font-weight: 700;
  letter-spacing: 0.5px;
}

.badge-mwf { background: #edf0f3; color: #5a6a7a; border: 1.5px solid #c8d0d8; }
.badge-tth { background: #edf0f3; color: #5a6a7a; border: 1.5px solid #c8d0d8; }


.schedule-notice {
  text-align: center;
  margin-bottom: 20px;
  line-height: 2;
}

.schedule-notice .notice-line {
  display: inline-block;
  background: white;
  border-radius: 10px;
  padding: 7px 20px;
  font-size: 0.88rem;
  font-weight: 700;
  color: #4a5568;
  box-shadow: 0 2px 10px rgba(58,58,110,0.08);
  letter-spacing: 0.3px;
}

.schedule-notice .notice-name {
  color: #e05530;
  margin-right: 10px;
  font-size: 1.9rem;
  font-weight: 900;
  font-family: 'Gaegu', cursive;
  vertical-align: middle;
  line-height: 1;
}

/* â”€â”€â”€ í…Œì´ë¸” â”€â”€â”€ */
.table-wrap {
  background: white;
  border-radius: 20px;
  box-shadow: 0 6px 40px rgba(58,58,110,0.12);
  overflow: hidden;
  overflow-x: auto;
}

table {
  width: 100%;
  border-collapse: collapse;
  min-width: 620px;
}

/* í—¤ë” */
thead th {
  padding: 14px 8px;
  font-size: 0.95rem;
  font-weight: 900;
  letter-spacing: 1px;
  color: white;
  text-align: center;
  border-bottom: 3px solid rgba(255,255,255,0.2);
}

th.h-time { background: #6b7280; font-size: 0.78rem; font-weight: 700; color: #e5e7eb; width: 110px; }
th.h-mon  { background: #7c8fa1; }
th.h-tue  { background: #7c8fa1; }
th.h-wed  { background: #7c8fa1; }
th.h-thu  { background: #7c8fa1; }
th.h-fri  { background: #7c8fa1; }

/* ë°”ë”” í–‰ */
tbody tr {
  border-bottom: 1px solid #eaecee;
}
tbody tr:last-child { border-bottom: none; }
tbody tr:hover { background: #f9fafb; }

/* ì‹œê°„ ë ˆì´ë¸” ì»¬ëŸ¼ */
td.td-time {
  background: #f5f6f7;
  text-align: center;
  vertical-align: middle;
  padding: 4px 6px;
  border-right: 2px solid #e5e7ea;
}

.time-block {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  font-size: 0.78rem;
  font-weight: 700;
  color: #6b7280;
  white-space: nowrap;
}

.time-block input.time-input {
  width: 44px;
  border: none;
  background: transparent;
  font-family: 'Noto Sans KR', sans-serif;
  font-size: 0.78rem;
  font-weight: 700;
  color: #6b7280;
  text-align: center;
  padding: 2px 0;
  border-bottom: 1.5px dashed #c4c9d0;
  outline: none;
  cursor: text;
}

.time-block input.time-input:focus {
  border-bottom-color: #7c8fa1;
  background: #f4f6f8;
  border-radius: 3px;
}

.time-sep { color: #aab; font-size: 0.7rem; }

/* ê³¼ëª© ì…ë ¥ ì…€ */
td.cell {
  height: 76px;
  padding: 0;
  vertical-align: middle;
  text-align: center;
}

td.cell textarea.subj {
  width: 100%;
  height: 100%;
  border: none;
  outline: none;
  background: transparent;
  font-family: 'Noto Sans KR', sans-serif;
  font-size: 0.88rem;
  font-weight: 700;
  text-align: center;
  padding: 10px 8px;
  cursor: pointer;
  transition: background 0.15s;
  resize: none;
  line-height: 1.6;
  display: block;
}

td.cell textarea.subj::placeholder {
  font-weight: 400;
  font-size: 0.72rem;
}

/* í†µì¼ ìƒ‰ìƒ - ë®¤íŠ¸ í†¤ */
td.cell textarea.subj { color: #4a5568; }
td.cell textarea.subj:focus { background: #f4f6f8; }
td.cell textarea.subj::placeholder { color: #b0b8c4; }

/* ë¹„í™œì„± ì…€ */
td.cell.inactive {
  background: repeating-linear-gradient(
    45deg,
    #f5f5fa,
    #f5f5fa 4px,
    #eeeef5 4px,
    #eeeef5 8px
  );
}
td.cell.inactive textarea.subj {
  pointer-events: none;
  color: transparent !important;
}

.share-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 22px;
  background: white;
  border-radius: 12px;
  padding: 10px 16px;
  box-shadow: 0 2px 12px rgba(58,58,110,0.08);
  flex-wrap: wrap;
}

.share-label {
  font-size: 0.8rem;
  font-weight: 700;
  color: #6b7280;
  white-space: nowrap;
}

.share-bar input {
  flex: 1;
  border: 1.5px solid #e0e3e8;
  border-radius: 8px;
  padding: 7px 12px;
  font-size: 0.78rem;
  color: #4a5568;
  background: #f8f9fa;
  outline: none;
  min-width: 200px;
  font-family: monospace;
}

.share-bar button {
  padding: 8px 18px;
  background: #7c8fa1;
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 0.82rem;
  font-weight: 700;
  cursor: pointer;
  white-space: nowrap;
  font-family: 'Noto Sans KR', sans-serif;
  transition: transform 0.15s;
}

.share-bar button:hover { transform: translateY(-1px); }

/* ë²„íŠ¼ */
.btn-row {
  display: flex;
  gap: 12px;
  justify-content: center;
  margin-top: 24px;
  flex-wrap: wrap;
}

button {
  padding: 11px 28px;
  border: none;
  border-radius: 50px;
  font-family: 'Noto Sans KR', sans-serif;
  font-size: 0.88rem;
  font-weight: 700;
  cursor: pointer;
  transition: transform 0.15s, box-shadow 0.15s;
  letter-spacing: 0.5px;
}

button:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.15); }
button:active { transform: translateY(0); }

.btn-save  { background: #5a7a6a; color: white; }
.btn-print { background: #6b7a8a; color: white; }
.btn-reset-time { background: #888; color: white; }
.btn-clear { background: #8a6a6a; color: white; }

.tip {
  text-align: center;
  font-size: 0.75rem;
  color: #aaa;
  margin-top: 14px;
}

@media print {
  body { background: white; padding: 10px; }
  .btn-row, .tip, .info-badges, .subtitle { display: none; }
  h1 { font-size: 2rem; color: #333; }
  .table-wrap { box-shadow: none; }
  .time-block input.time-input { border-bottom: none; }
  td.cell.inactive { background: #f0f0f0; }
}
</style>
</head>
<body>
<div class="container">
  <h1>ìœ í•˜ ì‹œê°„í‘œ</h1>
  <p class="subtitle">í•™ì›Â·í™œë™ ì´ë¦„ì„ ì¹¸ì— ì…ë ¥í•˜ê³ , ì‹œê°„ë„ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆì–´ìš”!</p>

  <div class="info-badges">
    <span class="badge badge-mwf">ğŸ« ì›”Â·ìˆ˜Â·ê¸ˆ â€” 1:40 í•˜êµ</span>
    <span class="badge badge-tth">ğŸ« í™”Â·ëª© â€” 12:50 í•˜êµ</span>
  </div>


  <div class="schedule-notice">
    <div class="notice-line"><span class="notice-name">ì œí•˜</span>08:30 4ë‹¨ì§€ íš¡ë‹¨ë³´ë„ &nbsp;/&nbsp; 16:30 4ë‹¨ì§€ íš¡ë‹¨ë³´ë„</div>
  </div>

  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th class="h-time">ì‹œê°„</th>
          <th class="h-mon">ì›”ìš”ì¼</th>
          <th class="h-tue">í™”ìš”ì¼</th>
          <th class="h-wed">ìˆ˜ìš”ì¼</th>
          <th class="h-thu">ëª©ìš”ì¼</th>
          <th class="h-fri">ê¸ˆìš”ì¼</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>

  <div class="share-bar">
    <span class="share-label">ğŸ“ ê³µìœ  ë§í¬</span>
    <input type="text" id="share-url" readonly placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ë©´ ë§í¬ê°€ ìƒì„±ë©ë‹ˆë‹¤">
    <button id="copy-btn" onclick="copyURL()">ğŸ”— ë§í¬ ë³µì‚¬</button>
  </div>

  <div class="btn-row">
    <button class="btn-save" onclick="saveAll()">ğŸ’¾ ì €ì¥</button>
    <button class="btn-reset-time" onclick="resetTimes()">ğŸ”„ ì‹œê°„ ì´ˆê¸°í™”</button>
    <button class="btn-print" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„</button>
    <button class="btn-clear" onclick="clearAll()">ğŸ—‘ï¸ ì „ì²´ ì§€ìš°ê¸°</button>
  </div>
  <p class="tip">â± ì‹œê°„ ì¹¸ì„ í´ë¦­í•˜ë©´ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆì–´ìš” &nbsp;|&nbsp; ì…ë ¥ ë‚´ìš©ì€ ìë™ ì €ì¥ë©ë‹ˆë‹¤</p>
</div>

<script>
// â”€â”€ ê¸°ë³¸ ì‹œê°„ ìŠ¬ë¡¯ ì •ì˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ì›”ìˆ˜ê¸ˆ: 13:40 í•˜êµ â†’ 14:00, 15:00, 16:00, 17:00
// í™”ëª©  : 12:50 í•˜êµ â†’ 13:00, 14:00, 15:00, 16:00, 17:00

const DEFAULT_SLOTS = [
  { startH:13, startM:0,  endH:14, endM:0  },  // í™”ëª© ì „ìš© ì²« ìŠ¬ë¡¯
  { startH:14, startM:0,  endH:15, endM:0  },
  { startH:15, startM:0,  endH:16, endM:0  },
  { startH:16, startM:0,  endH:17, endM:0  },
];

// í™”ëª©(tue, thu)ì€ ìŠ¬ë¡¯ 0(13:00~14:00)ë„ í™œì„±
// ì›”ìˆ˜ê¸ˆ(mon, wed, fri)ì€ ìŠ¬ë¡¯ 0 ë¹„í™œì„±
const DAYS = ['mon','tue','wed','thu','fri'];
const ACTIVE_FROM = { mon:1, tue:0, wed:1, thu:0, fri:1 }; // í™œì„± ìŠ¬ë¡¯ ì‹œì‘ ì¸ë±ìŠ¤

const STORAGE_KEY_SLOTS = 'tt_slots';
const STORAGE_KEY_SUBJ  = 'tt_subj';

function loadSlots() {
  try {
    const s = localStorage.getItem(STORAGE_KEY_SLOTS);
    if (s) return JSON.parse(s);
  } catch(e) {}
  return JSON.parse(JSON.stringify(DEFAULT_SLOTS));
}

function loadSubjects() {
  try {
    const s = localStorage.getItem(STORAGE_KEY_SUBJ);
    if (s) return JSON.parse(s);
  } catch(e) {}
  return {};
}

function fmt(h, m) {
  return `${h}:${String(m).padStart(2,'0')}`;
}

let slots = loadSlots();
let subjects = loadSubjects();

function buildTable() {
  const tbody = document.getElementById('tbody');
  tbody.innerHTML = '';

  slots.forEach((slot, si) => {
    const tr = document.createElement('tr');

    // â”€â”€ ì‹œê°„ ì…€ â”€â”€
    const tdTime = document.createElement('td');
    tdTime.className = 'td-time';

    const block = document.createElement('div');
    block.className = 'time-block';

    // ì‹œì‘ ì‹œê°„ input
    const inStart = document.createElement('input');
    inStart.className = 'time-input';
    inStart.value = fmt(slot.startH, slot.startM);
    inStart.title = 'ì‹œì‘ ì‹œê°„ ìˆ˜ì • (ì˜ˆ: 14:00)';
    inStart.addEventListener('change', () => {
      const parsed = parseTime(inStart.value);
      if (parsed) {
        slots[si].startH = parsed.h;
        slots[si].startM = parsed.m;
        saveSlots();
      } else {
        inStart.value = fmt(slot.startH, slot.startM);
      }
    });

    const sep = document.createElement('span');
    sep.className = 'time-sep';
    sep.textContent = '~';

    // ì¢…ë£Œ ì‹œê°„ input
    const inEnd = document.createElement('input');
    inEnd.className = 'time-input';
    inEnd.value = fmt(slot.endH, slot.endM);
    inEnd.title = 'ì¢…ë£Œ ì‹œê°„ ìˆ˜ì • (ì˜ˆ: 15:00)';
    inEnd.addEventListener('change', () => {
      const parsed = parseTime(inEnd.value);
      if (parsed) {
        slots[si].endH = parsed.h;
        slots[si].endM = parsed.m;
        saveSlots();
      } else {
        inEnd.value = fmt(slot.endH, slot.endM);
      }
    });

    block.appendChild(inStart);
    block.appendChild(sep);
    block.appendChild(inEnd);
    tdTime.appendChild(block);
    tr.appendChild(tdTime);

    // â”€â”€ ìš”ì¼ ì…€ â”€â”€
    DAYS.forEach(day => {
      const active = si >= ACTIVE_FROM[day];
      const td = document.createElement('td');
      td.className = 'cell ' + day + (active ? '' : ' inactive');

      const inp = document.createElement('textarea');
      inp.className = 'subj';
      inp.rows = 2;

      if (active) {
        const key = `${day}_${si}`;
        inp.placeholder = 'í•™ì› / í™œë™';
        inp.value = subjects[key] || '';
        inp.addEventListener('input', () => {
          subjects[key] = inp.value;
          saveSubjects();
        });
      }

      td.appendChild(inp);
      tr.appendChild(td);
    });

    tbody.appendChild(tr);
  });
}

function parseTime(str) {
  const m = str.match(/^(\d{1,2}):(\d{2})$/);
  if (!m) return null;
  const h = parseInt(m[1]), min = parseInt(m[2]);
  if (h < 0 || h > 23 || min < 0 || min > 59) return null;
  return { h, m: min };
}

function saveSlots()    { localStorage.setItem(STORAGE_KEY_SLOTS, JSON.stringify(slots)); }
function saveSubjects()  { localStorage.setItem(STORAGE_KEY_SUBJ, JSON.stringify(subjects)); }

function saveAll() {
  saveSlots();
  saveSubjects();
  const btn = document.querySelector('.btn-save');
  btn.textContent = 'âœ… ì €ì¥ë¨!';
  setTimeout(() => btn.textContent = 'ğŸ’¾ ì €ì¥', 1500);
}

function resetTimes() {
  if (!confirm('ì‹œê°„ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”í• ê¹Œìš”?')) return;
  slots = JSON.parse(JSON.stringify(DEFAULT_SLOTS));
  saveSlots();
  buildTable();
}

function clearAll() {
  if (!confirm('ê³¼ëª© ë‚´ìš©ì„ ëª¨ë‘ ì§€ìš¸ê¹Œìš”?')) return;
  subjects = {};
  saveSubjects();
  updateShareURL();
  buildTable();
}

// â”€â”€ URL ê³µìœ  ê¸°ëŠ¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function encodeState() {
  const data = { slots, subjects };
  return btoa(encodeURIComponent(JSON.stringify(data)));
}

function decodeState(encoded) {
  try {
    return JSON.parse(decodeURIComponent(atob(encoded)));
  } catch(e) { return null; }
}

function updateShareURL() {
  const encoded = encodeState();
  const url = location.origin + location.pathname + '?data=' + encoded;
  const el = document.getElementById('share-url');
  if (el) el.value = url;
}

function copyURL() {
  const el = document.getElementById('share-url');
  el.select();
  document.execCommand('copy');
  const btn = document.getElementById('copy-btn');
  btn.textContent = 'âœ… ë³µì‚¬ë¨!';
  setTimeout(() => btn.textContent = 'ğŸ”— ë§í¬ ë³µì‚¬', 1500);
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ URLì—ì„œ ë°ì´í„° ë³µì›
function loadFromURL() {
  const params = new URLSearchParams(location.search);
  const data = params.get('data');
  if (data) {
    const parsed = decodeState(data);
    if (parsed) {
      if (parsed.slots) slots = parsed.slots;
      if (parsed.subjects) subjects = parsed.subjects;
    }
  }
}

loadFromURL();
buildTable();
updateShareURL();

// ë‚´ìš© ë³€ê²½ ì‹œ URL ìë™ ê°±ì‹ 
const origSaveSubjects = saveSubjects;
saveSubjects = function() {
  origSaveSubjects();
  updateShareURL();
};
const origSaveSlots = saveSlots;
saveSlots = function() {
  origSaveSlots();
  updateShareURL();
};
</script>
</body>
</html>
